{% extends "admin/change_list.html" %}
{% load i18n unfold %}
{% load accounting_filters %}

{% block content_title %}
    <h1>Ein-/Ausgaben Management</h1>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script>
    // Markiere den richtigen Tab als aktiv basierend auf URL
    document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const isDashboard = urlParams.get('view') === 'dashboard';

        // Finde alle Tab-Links
        const tabs = document.querySelectorAll('a[href*="accounting_accountingentry"]');
        tabs.forEach(tab => {
            const href = tab.getAttribute('href');
            const isTabDashboard = href && href.includes('view=dashboard');

            // Entferne aktive Klassen von allen Tabs
            tab.classList.remove('border-primary-600', 'dark:border-primary-500', 'text-primary-600', 'dark:text-primary-400');

            // FÃ¼ge aktive Klasse zum richtigen Tab hinzu
            if ((isDashboard && isTabDashboard) || (!isDashboard && !isTabDashboard)) {
                tab.classList.add('border-primary-600', 'dark:border-primary-500', 'text-primary-600', 'dark:text-primary-400');
            }
        });
    });
</script>
{% endblock %}

{% block content %}
    <div style="margin-bottom: 2rem; width: 100%; order: -1;">
        <div style="display: flex; gap: 1.5rem; flex-wrap: wrap; width: 100%;">

            {# Card 1: Einnahmen #}
            <div style="flex: 1; min-width: 250px; border: 1px solid #374151; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                <h3 style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">
                    ðŸ’° Gesamt Einnahmen
                </h3>
                <p style="font-size: 1.875rem; font-weight: bold; color: #10b981; margin-bottom: 0.5rem;">
                    {{ total_income|format_thousands }}â‚¬
                </p>
                <p style="font-size: 0.75rem;">
                    Alle bezahlten Rechnungen
                </p>
            </div>

            {# Card 2: Ausgaben #}
            <div style="flex: 1; min-width: 250px; border: 1px solid #374151; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                <h3 style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">
                    ðŸ’¸ Gesamt Ausgaben
                </h3>
                <p style="font-size: 1.875rem; font-weight: bold; color: #ef4444; margin-bottom: 0.5rem;">
                    {{ total_expense|format_thousands }}â‚¬
                </p>
                <p style="font-size: 0.75rem;">
                    Stornierungen & Gegenbuchungen
                </p>
            </div>

            {# Card 3: Gewinn #}
            <div style="flex: 1; min-width: 250px; border: 1px solid #374151; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                <h3 style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">
                    ðŸ“Š Netto Gewinn
                </h3>
                <p style="font-size: 1.875rem; font-weight: bold; color: {% if net_profit >= 0 %}#3b82f6{% else %}#ef4444{% endif %}; margin-bottom: 0.5rem;">
                    {{ net_profit|format_thousands }}â‚¬
                </p>
                <p style="font-size: 0.75rem;">
                    Einnahmen minus Ausgaben
                </p>
            </div>

        </div>
    </div>

    {# Original content (search, filter, tabelle) #}
    {{ block.super }}
{% endblock %}